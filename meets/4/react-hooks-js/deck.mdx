import { Head, Image, Notes, Appear, Steps } from 'mdx-deck'
import Counter from './Counter'
import CustomHook from '!raw-loader!./CustomHook.jsx'
import CustomLiveCode from './CustomLiveCode'
import Footer from './Footer'
import FunctionalUpdate from '!raw-loader!./FunctionalUpdate.jsx'
import Lifecycles from '!raw-loader!./Lifecycles.jsx'
import SetState from '!raw-loader!./SetState.jsx'
import UseEffect from '!raw-loader!./UseEffect.jsx'
import UseEffectParameters from '!raw-loader!./UseEffectParameters.jsx'
import UseState from '!raw-loader!./UseState.jsx'
import useCustomHook from 'UseCustomHook.jsx'
import UseRef from '!raw-loader!./UseRef.jsx'
import UseLayoutEffect from '!raw-loader!./UseLayoutEffect.jsx'
import WrappedRefComponent from 'RefComponent.jsx'
import UseImperativeHandle from '!raw-loader!./UseImperativeHandle.jsx'
import UseCallback from '!raw-loader!./UseCallback.jsx'
import ButtonMemoized from 'ButtonMemoized.jsx'
import UseReducer from '!raw-loader!./UseReducer.jsx'
import NumberReducer from 'NumberReducer.jsx'
import UseEffecttest from 'UseEffecttest.jsx'
import CustomHooktest from 'CustomHooktest.jsx'
import CustomHooktest2 from 'CustomHooktest2.jsx'
import UseReducertest from 'UseReducertest.jsx'
import UseReftest from 'UseReftest.jsx'
import UseImperativeHandletest from 'UseImperativeHandletest.jsx'
import UseCallbacktest from 'UseCallbacktest.jsx'

export { swiss as theme } from '@mdx-deck/themes'

<Head>
	<title>React Hooks</title>
</Head>

# React Hooks

15.10.2019

Torsten Stelljes

<Footer/>

---

<CustomLiveCode title={'setState'} code={SetState} />

---

<CustomLiveCode title={'useState'} code={UseState} />

---

<CustomLiveCode title={'life cycles'} code={Lifecycles} />

---

<CustomLiveCode title={'useEffect'} code={UseEffect} />

---

<CustomLiveCode title={'useEffect parameters'} code={UseEffectParameters} />

---

# subscription with useEffect

```jsx
import React, {useEffect} from 'react'

const ComponentWithSubscription = () => {
  // ...
  useEffect(() => {
    subscribeToSomething(/*...*/)
    return () => {
      unsubscribeFromSomething(/*...*/)
    }
  })
  // ...
}
```

<Footer/>

---

# subscription with life cycles

```jsx
import React from 'react'

class ComponentWithSubscription extends React.Component {
  // ...
  componentDidMount() {
    subscribeToSomething(/*...*/)
  }
  componentDidUpdate() {
    subscribeToSomething(/*...*/)
    unsubscribeFromSomething(/*...*/)
  }
  componentDidUnmount() {
    unsubscribeFromSomething(/*...*/)
  }
  // ...
}
```

<Footer/>

---

<CustomLiveCode title={'functional update'} code={FunctionalUpdate} />

---

# Rules

<ul>
<Appear>
<li>Hooks always start with 'use'</li>
<li>Only call hooks from functional components or custom hooks</li>
<li>Only call hooks at the top level</li>
</Appear>
</ul>

<Footer/>

---

# a custom hook to be used

```jsx
const useCustomHook = interval => {
    const [count, setCount] = useState(0)

    useEffect(() => {
        const id = setInterval(() => {
            setCount(count => count + 1)
        }, interval)
        return () => clearInterval(id)
    }, [])

    return <p>{count}</p>
}
```

<Footer/>

---

<CustomLiveCode title={'custom hooks'} code={CustomHook} scope={{useCustomHook}}/>

---

<CustomLiveCode title={'useReducer'} code={UseReducer} scope={{NumberReducer}}/>

---

# the number reducer

```jsx
const NumberReducer = (state, action) => {
    switch (action.type) {
        case 'add':
            return [... state, state[state.length-1] + action.number]
        case 'circumference':
            return [... state, 2 * state[state.length-1] * Math.PI]
        case 'area':
            return [... state, Math.pow(state[state.length-1],2) * Math.PI]
        case 'undo':
            return [...state.slice(0,state.length-1)]
        default:
            return state
    }
}
```

<Footer/>

---

<div>
<UseReducertest />
</div>

---

# lazy initialization

```jsx
const UseStateWithLazyInitialization = () => {
  const [state, setState] = useState(initFunction)
  // ...
}

const UseReducerWithLazyInitialization = () => {
  const [state, setState] = useReducer(reducer, initParameter, initFunction)
  // ...
}
```

<Footer/>

---

<CustomLiveCode title={'useRef'} code={UseRef}/>

---

<CustomLiveCode title={'useLayoutEffect'} code={UseLayoutEffect}/>

---

# wrapped ref component

```jsx
const RefComponent = (props, ref) => {
    const inputRef = useRef(null)
    useImperativeHandle(ref, () => ({
        focus: () => {
            inputRef.current.focus()
        }
    }))
    return (
        <>
            <input ref={inputRef} type="color" value="#e66465" />
        </>
    )
}
export default forwardRef(RefComponent)
```

<Footer/>

---

<CustomLiveCode title={'useImperativeHandle'} code={UseImperativeHandle} scope={{WrappedRefComponent}}/>

---

# memoized button

```jsx
const ButtonMemoized = React.memo(
    ({onClick, text}) => <button onClick={onClick}>{text}</button>
)
```

<Footer/>

---

<CustomLiveCode title={'useCallback'} code={UseCallback} scope={{ButtonMemoized}}/>

---

# useMemo

```jsx
const ComponentWithExpensiveComputation = () => {
    const [a, setA] = useState(0)
    const [b, setB] = useState(0)

    const computeExpensiveValue = x => {*/...*/}

    const c = useMemo(() => computeExpensiveValue(b), [b])

    return <p>{c}</p>
}
```

<Footer/>

---

# further hooks

<ul>
<Appear>
<li>useContext: get context from the closest context provider</li>
<li>useDebugValue: display a label for custom hooks in React DevTools</li>
</Appear>
</ul>

<Footer/>

---

<div>
<UseCallbacktest />
</div>

---

<div>
<UseImperativeHandletest />
</div>

---

<div>
<CustomHooktest />
</div>

---

<div>
<CustomHooktest2 />
</div>

---

<CustomLiveCode title={'react-live'} code={`() => {
    const [count, setCount] = useState(0)
    return (
        <>
            Count: {count}
            <button onClick={() => setCount(0)}>Reset</button>
            <button onClick={() => setCount(prevCount => prevCount + 1)}>+</button>
            <button onClick={() => setCount(prevCount => prevCount - 1)}>-</button>
        </>
    )
}`
} />

```jsx
import React from 'react'

export default props =>
  <div style={{ color: 'red' }}>
    {props.children}
  </div>

export const Beep = props =>
  <Hello>
    {props.children}
  </Hello>

```

## This is v2

---

## What's New

<ul>
  <Appear>
    <li>Reach Router</li>
    <li>Less opinionated styles</li>
    <li>more stuff</li>
  </Appear>
</ul>

---

<Image
  src='https://source.unsplash.com/random/1024x768'
  size='contain'
/>

---

## This slide has notes

<Notes>
  Hello, secret speaker notes
</Notes>

---

```js
const codeExample = require('./code-example')
```

---

## More Appear

<Appear>
  <div>One</div>
  <div>Two</div>
  <div>Three</div>
  <div>Four</div>
  <div>Five</div>
  <div>Six</div>
</Appear>

---

## Steps Components

<Steps
  length={3}
  render={({ step }) => (
    <pre>
      Step: {step}
    </pre>
  )}
/>

---

## Last Slide